webpackJsonp([31],{MNcb:function(e,t){},YUU8:function(e,t){},zPaH:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("Dd8w"),i=r.n(s),n=r("vMJZ"),o=r("NC6I"),a=r.n(o),l=r("UK/b"),u=r("E4LH"),f={props:["dialogVisible","tradeStatus","safeStatus","userInfo"],data:function(){var e=this;return{formVisible:!0,safeInfo:{},ruleForm:{question_answer_1:null,question_answer_2:null,question_id_1:0,question_id_2:0},setPwd:{label1:this.$t("user.safeCenfity.setPwd")},resetForm:{new_password:"",new_confirmpwd:"",sms_verify:""},validCode:!0,validTip:this.$t("verifyCode.title"),resetRules:{new_password:[{validator:function(t,r,s){""===r?s(new Error(e.$t("errorTips.withoutPwd"))):(Object(u.f)(r)||s(new Error(e.$t("errorTips.tradePwdError"))),Object(u.g)(r)||s(new Error(e.$t("tradePwd.part15"))),s())},trigger:"blur"},{required:!0,message:this.$t("errorTips.withoutPwd"),trigger:"blur"}],new_confirmpwd:[{required:!0,message:this.$t("errorTips.tradePwdError"),trigger:"blur"},{validator:function(t,r,s){""===r?s(new Error(e.$t("errorTips.surePwd"))):r!==e.resetForm.new_password?s(new Error(e.$t("errorTips.surePwdError"))):s()},trigger:"blur"}],sms_verify:[{required:!0,message:this.$t("errorTips.withoutVerifyCode"),trigger:"blur"}]},title:this.$t("user.safeCenfity.title"),rules:{question_answer_1:[{required:!0,message:this.$t("user.safeCenfity.tips.part3"),trigger:"blur"}],question_answer_2:[{required:!0,message:this.$t("user.safeCenfity.tips.part3"),trigger:"blur"}]}}},mounted:function(){this.safeStatus&&"1"===this.safeStatus&&this.initSafeQuestion()},methods:{handleCloseDialog:function(){this.$emit("closeDialog","safeCentifyDialogVisible")},handleReset:function(){this.initSafeQuestion()},initSafeQuestion:function(){var e=this;Object(n.a)().then(function(t){if(1e3!==t.status)return e.$message.error(t.msg),!1;e.$set(e.safeInfo,"question1",t.data[0].question_detail),e.$set(e.safeInfo,"question2",t.data[1].question_detail),e.ruleForm.question_id_1=t.data[0].id,e.ruleForm.question_id_2=t.data[1].id}).catch(function(){})},formSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var r=i()({},t.ruleForm);Object(n.c)(r).then(function(e){if(1e3!==e.status)return t.$message.error(e.msg),!1;t.$message.success(t.$t("translateLang.user.text6")),t.formVisible=!1,0===t.tradeStatus?t.title=t.$t("user.safeCenfity.title"):(t.title=t.$t("user.safeCenfity.title2"),t.setPwd.label1=t.$t("user.safeCenfity.newpwd"))}).catch(function(){})})},setSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var r=i()({},t.resetForm);r.password=a()(r.new_password),r.confirm_password=a()(r.new_confirmpwd),Object(n.v)(r).then(function(e){if(1e3!==e.status)return t.$message.error(e.msg),!1;t.$emit("change",!0),t.$message.success(t.$t("user.safeCenfity.tips.part5")),t.handleCloseDialog()}).catch(function(){})})},handleSendRequestSms:function(e){var t=this,r={};this.setTime(),r.user_account=this.userInfo.phone,r.request_type="edit",Object(l.d)(r).then(function(e){if(1e3!==e.status)return t.$message.error(e.msg),!1}).catch(function(){})},setTime:function(){var e=60;if(this.validCode){this.validCode=!1;var t=this,r=setInterval(function(){e--,t.validTip=e+t.$t("verifyCode.second"),0===e&&(clearInterval(r),t.validTip=t.$t("verifyCode.getAgain"),t.validCode=!0)},1e3);return r}}}},d={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{staticClass:"safe-Centify-dialog",attrs:{title:e.title,visible:e.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.handleCloseDialog,width:"580px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("div",[r("el-form",{ref:"resetForm",attrs:{model:e.resetForm,rules:e.resetRules,"label-width":"140px"}},[r("el-form-item",{attrs:{label:e.setPwd.label1,prop:"new_password"}},[r("el-input",{attrs:{type:"password",placeholder:e.$t("tradePwd.part12")},model:{value:e.resetForm.new_password,callback:function(t){e.$set(e.resetForm,"new_password","string"==typeof t?t.trim():t)},expression:"resetForm.new_password"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("user.safeCenfity.confirm"),prop:"new_confirmpwd"}},[r("el-input",{attrs:{type:"password"},model:{value:e.resetForm.new_confirmpwd,callback:function(t){e.$set(e.resetForm,"new_confirmpwd","string"==typeof t?t.trim():t)},expression:"resetForm.new_confirmpwd"}})],1),e._v(" "),e.userInfo?r("el-form-item",{attrs:{label:e.$t("translateLang.user.text5")}},[r("span",{staticClass:"phone"},[e._v(e._s(e._f("crypto")(e.userInfo.phone)))])]):e._e(),e._v(" "),r("el-form-item",{staticClass:"verify",attrs:{label:e.$t("user.bindPhoneDialog.code"),prop:"sms_verify"}},[r("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:e.$t("user.bindPhoneDialog.codePlaceholder")},model:{value:e.resetForm.sms_verify,callback:function(t){e.$set(e.resetForm,"sms_verify","string"==typeof t?t.trim():t)},expression:"resetForm.sms_verify"}}),e._v(" "),r("el-button",{staticClass:"get-verify",attrs:{disabled:!e.validCode},on:{click:function(t){e.handleSendRequestSms(t)}}},[e._v(e._s(e.validTip)+"\n          ")])],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.setSubmit("resetForm")}}},[e._v(e._s(e.$t("dialog.sure")))])],1)],1)],1)])},staticRenderFns:[]};var c=r("VU/8")(f,d,!1,function(e){r("YUU8"),r("MNcb")},"data-v-3918ef66",null);t.default=c.exports}});