webpackJsonp([32],{"/eWP":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("Dd8w"),s=r.n(i),a=r("NC6I"),n=r.n(a),o=r("vMJZ"),l=r("1zv/"),u={props:["isLogin","tradeInfo","isSurePrice"],components:{passwordDialog:r("Dopa").default},data:function(){var t=this;return{isToCnyHidden:!1,trade_currency_name:"",isDisable:!0,slideData:0,load:1,tips:this.$t("translateLang.tradeDetail.text7"),dialogVisible:!1,userInfo:{},ruleForm:{buy_price:0,buy_num:0,trade_password:"",pass_double:""},rules:{buy_price:[{validator:function(e,r,i){""===r?(t.isToCnyHidden=!0,i(new Error(t.$t("translateLang.tradeDetail.text76")))):"0"===r||0===r?(t.isToCnyHidden=!0,i(new Error(t.$t("translateLang.tradeDetail.text77")))):/^[0-9]([0-9]|\.)*$/.test(r)?r>parseFloat(t.tradeInfo.currency_buy_balance)?(t.isToCnyHidden=!0,i(new Error(t.$t("tradeDetail.buy.part14")))):parseFloat(t.ruleForm.buy_price)<1.1*t.tradeInfo.last_buy_price?i():(t.isToCnyHidden=!0,i(new Error(t.$t("translateLang.tradeDetail.text8")))):(t.isToCnyHidden=!0,i(new Error(t.$t("tradeDetail.buy.part13"))))}}],buy_num:[{validator:function(e,r,i){""===r||"0"===r||0===r?i(new Error(t.$t("tradeDetail.buy.part15"))):/^[0-9]([0-9]|\.)*$/.test(r)?r>parseFloat(t.mostBy)?i(new Error(t.$t("tradeDetail.buy.part17"))):i():i(new Error(t.$t("tradeDetail.buy.part16")))}}]}}},computed:{mostBy:function(){return 0===this.ruleForm.buy_price||""===this.ruleForm.buy_price?0:Math.floor(parseFloat(this.tradeInfo.currency_buy_balance)/parseFloat(this.ruleForm.buy_price)*1e5)/1e5},toCny:function(){return(this.tradeInfo.exchange_cny_price*this.ruleForm.buy_price).toFixed(2)},toHkb:function(){return(this.tradeInfo.exchange_hkd_price*this.ruleForm.buy_price).toFixed(2)},toUsb:function(){return(this.tradeInfo.exchange_usd_price*this.ruleForm.buy_price).toFixed(2)},convert:function(){return Math.floor(this.ruleForm.buy_price*this.ruleForm.buy_num*1e5)/1e5},percent:function(){return this.ruleForm.buy_num/this.mostBy<=1?(this.ruleForm.buy_num/this.mostBy).toFixed(3):0}},watch:{tradeInfo:function(){this.ruleForm.buy_price=this.tradeInfo.last_buy_price}},created:function(){this.initUserInfo(),this.ruleForm.buy_price=this.tradeInfo.last_buy_price,this.trade_currency_name=this.$store.state.trade_currency_name,this.isLogin?this.isDisable=!1:this.isDisable=!0},methods:{closeDialog:function(t){this[t]=!1},initUserInfo:function(){var t=this;window.localStorage.getItem("link_userInfo")&&Object(o.z)().then(function(e){if(1e3!==e.status)return!1;t.userInfo=e.data,0===parseFloat(t.userInfo.is_set_double_certification)&&(t.ruleForm.pass_double="0")}).catch(function(){})},submitForm:function(t){var e=this;return 1!==this.userInfo.status?(this.$message.error(this.$t("translateLang.tradeDetail.text71")),!1):"1"!==this.userInfo.is_pwdtrade_exists.toString()?(this.$message.error(this.$t("translateLang.tradeDetail.text72")),!1):void this.$refs[t].validate(function(t){if(!t)return e.changeByPrice(),parseFloat(e.ruleForm.buy_price)<1.1*e.tradeInfo.last_buy_price||(e.isToCnyHidden=!0),!1;e.dialogVisible=!0})},submitData:function(t){var e=this,r=s()({},this.ruleForm);r.currency_id=this.tradeInfo.currency_id,r.trade_area_id=this.tradeInfo.trade_area_id,r.trade_password=n()(t),r.price_type=this.isSurePrice?1:2,this.dialogVisible=!1,Object(l.h)(r).then(function(t){if(1e3!==t.status)return e.$message.error(t.msg),!1;e.resetForm("ruleForm"),e.$emit("refresh"),e.$message.success(e.$t("tradeDetail.buy.part18"))}).catch(function(){})},changeByPrice:function(){return this.ruleForm.buy_price||(this.slideData=0,this.ruleForm.buy_num=""),/.{1}/.test(this.ruleForm.buy_price)?(this.isToCnyHidden=!1,/^[0-9]*.[0-9]{0,6}$/.test(this.ruleForm.buy_price)||(this.ruleForm.buy_price=this.ruleForm.buy_price.match(/^[0-9]*.[0-9]{0,5}/)[0])):this.isToCnyHidden=!0,parseFloat(this.ruleForm.buy_price)&&/^[0-9]([0-9]|\.)*$/.test(this.ruleForm.buy_price)?this.ruleForm.buy_price>parseFloat(this.tradeInfo.currency_buy_balance)?(this.isToCnyHidden=!0,!1):void 0:(this.isToCnyHidden=!0,!1)},changeByRange:function(){if(!this.ruleForm.buy_price)return this.slideData=0,!1;var t=parseFloat(this.tradeInfo.currency_buy_balance)/parseFloat(this.ruleForm.buy_price),e=t*this.slideData/100;isFinite(t)||(e=0),this.ruleForm.buy_num=e?Math.floor(1e5*e)/1e5:0},changeByNum:function(){/.{1}/.test(this.ruleForm.buy_num)&&(/^[0-9]*.[0-9]{0,2}$/.test(this.ruleForm.buy_num)||(this.ruleForm.buy_num=this.ruleForm.buy_num.match(/^[0-9]*.[0-9]{0,1}/)[0])),this.percent<=1?this.slideData=100*parseFloat(this.percent):this.slideData=0},resetForm:function(t){this.$refs[t].resetFields()}}},c={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"buy-form"},[r("div",{staticClass:"title-second"},[t._v(t._s(t.$t("tradeDetail.buy.part2"))+" "+t._s(t.tradeInfo.trade_currency_mark)+"： "),r("span",{staticClass:"c-green"},[t._v(t._s(t.tradeInfo.currency_buy_balance))])]),t._v(" "),r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules}},[0==t.isSurePrice?r("el-form-item",{staticClass:"to-cny-container",attrs:{prop:"buy_price",label:t.$t("translateLang.tradeDetail.text1")}},[r("el-input",{attrs:{placeholder:t.$t("tradeDetail.buy.part4"),disabled:t.isDisable},on:{input:function(e){t.changeByPrice()}},model:{value:t.ruleForm.buy_price,callback:function(e){t.$set(t.ruleForm,"buy_price","string"==typeof e?e.trim():e)},expression:"ruleForm.buy_price"}}),t._v(" "),"zn"==t.$i18n.locale?r("span",{staticClass:"to-cny",class:{hidden:t.isToCnyHidden}},[t._v(" ≈ "+t._s(t.toCny)+" CNY")]):t._e(),t._v(" "),"zh-hk"==t.$i18n.locale?r("span",{staticClass:"to-cny",class:{hidden:t.isToCnyHidden}},[t._v(" ≈ HK$ "+t._s(t.toHkb)+" ")]):t._e(),t._v(" "),"en"==t.$i18n.locale?r("span",{staticClass:"to-cny",class:{hidden:t.isToCnyHidden}},[t._v(" ≈ $ "+t._s(t.toUsb))]):t._e()],1):t._e(),t._v(" "),1==t.isSurePrice?r("el-form-item",{staticClass:"to-cny-container",attrs:{prop:"buy_price",label:t.$t("translateLang.tradeDetail.text1")}},[r("el-input",{attrs:{disabled:""},on:{input:function(e){t.changeByPrice()}},model:{value:t.tips,callback:function(e){t.tips=e},expression:"tips"}}),t._v(" "),"zn"==t.$i18n.locale?r("span",{staticClass:"to-cny",class:{hidden:t.isToCnyHidden}},[t._v(" ≈ "+t._s(t.toCny)+" CNY")]):t._e(),t._v(" "),"zh-hk"==t.$i18n.locale?r("span",{staticClass:"to-cny",class:{hidden:t.isToCnyHidden}},[t._v(" ≈ HK$ "+t._s(t.toHkb))]):t._e(),t._v(" "),"en"==t.$i18n.locale?r("span",{staticClass:"to-cny",class:{hidden:t.isToCnyHidden}},[t._v(" ≈ $ "+t._s(t.toUsb))]):t._e()],1):t._e(),t._v(" "),r("el-form-item",{attrs:{prop:"buy_num",label:t.$t("translateLang.tradeDetail.text2")}},[r("el-input",{attrs:{type:"number",placeholder:t.$t("tradeDetail.buy.part6"),disabled:t.isDisable},model:{value:t.ruleForm.buy_num,callback:function(e){t.$set(t.ruleForm,"buy_num","string"==typeof e?e.trim():e)},expression:"ruleForm.buy_num"}})],1),t._v(" "),r("div",{staticClass:"clearfix"},[r("el-slider",{staticClass:"pull-left slider",on:{input:function(e){if(e.target!==e.currentTarget)return null;t.changeByRange()}},model:{value:t.slideData,callback:function(e){t.slideData=e},expression:"slideData"}})],1),t._v(" "),r("div",{staticClass:"toComputed"},[r("span",{staticStyle:{width:"60px",display:"inline-block"}},[t._v("\n        "+t._s(t.$t("translateLang.tradeDetail.text3"))+"\n      ")]),t._v("\n        "+t._s(t.convert)+t._s(t.tradeInfo.trade_currency_mark)+" \n      "),r("span",{staticClass:"c-gray"},[t._v("("+t._s(t.$t("tradeDetail.buy.part9"))+t._s(t.tradeInfo.currency_buy_fee)+"%)")])]),t._v(" "),r("el-form-item",[r("el-button",{staticClass:"buy-btn1",attrs:{disabled:t.isDisable},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v(t._s(t.$t("tradeDetail.buy.part10")))])],1)],1),t._v(" "),r("password-dialog",{attrs:{dialogVisible:t.dialogVisible},on:{submitData:t.submitData,closeDialog:t.closeDialog}})],1)},staticRenderFns:[]};var d=r("VU/8")(u,c,!1,function(t){r("cDMN"),r("vnRY")},"data-v-23d75b5b",null);e.default=d.exports},cDMN:function(t,e){},vnRY:function(t,e){}});