webpackJsonp([25],{e67b:function(e,t){},eUba:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("Dd8w"),a=s.n(r),i=s("NC6I"),l=s.n(i),n=s("vMJZ"),o=s("1zv/"),c={props:["isLogin","tradeInfo","isSurePrice"],components:{passwordDialog:s("Dopa").default},data:function(){var e=this;return{isToCnyHidden:!1,trade_currency_name:"",isDisable:!0,slideData:0,userInfo:{},tips:this.$t("translateLang.tradeDetail.text49"),dialogVisible:!1,ruleForm:{sell_price:0,sell_num:0,trade_password:"",pass_double:""},rules:{sell_price:[{validator:function(t,s,r){""===s?(e.isToCnyHidden=!0,r(new Error(e.$t("translateLang.tradeDetail.text78")))):"0"===s?(e.isToCnyHidden=!0,r(new Error(e.$t("translateLang.tradeDetail.text79")))):/^[0-9]([0-9]|\.)*$/.test(s)?s>parseFloat(e.tradeInfo.currency_sell_balance)?(e.isToCnyHidden=!0,r(new Error(e.$t("tradeDetail.sell.part14")))):parseFloat(e.ruleForm.sell_price)>.9*e.tradeInfo.last_sell_price?r():(e.isToCnyHidden=!0,r(new Error(e.$t("translateLang.tradeDetail.text50")))):(e.isToCnyHidden=!0,r(new Error(e.$t("tradeDetail.sell.part13"))))}}],sell_num:[{validator:function(t,s,r){""===s?(e.isToCnyHidden=!0,r(new Error("卖出量不能为空"))):"0"===s?(e.isToCnyHidden=!0,r(new Error("卖出量不能为0"))):/^[0-9]([0-9]|\.)*$/.test(s)?s>parseFloat(e.tradeInfo.currency_sell_balance)?r(new Error(e.$t("tradeDetail.sell.part17"))):r():r(new Error(e.$t("tradeDetail.sell.part16")))}}]}}},computed:{toCny:function(){return(this.tradeInfo.exchange_cny_price*this.ruleForm.sell_price).toFixed(2)},toHkb:function(){return(this.tradeInfo.exchange_hkd_price*this.ruleForm.sell_price).toFixed(2)},toUsb:function(){return(this.tradeInfo.exchange_usd_price*this.ruleForm.sell_price).toFixed(2)},convert:function(){return Math.floor(this.ruleForm.sell_price*this.ruleForm.sell_num*1e5)/1e5},percent:function(){return parseFloat(this.ruleForm.sell_num)/parseFloat(this.tradeInfo.currency_sell_balance)<=1?(parseFloat(this.ruleForm.sell_num)/parseFloat(this.tradeInfo.currency_sell_balance)).toFixed(3):0}},watch:{tradeInfo:function(){this.ruleForm.sell_price=this.tradeInfo.last_sell_price}},created:function(){this.initUserInfo(),this.ruleForm.sell_price=this.tradeInfo.last_sell_price,this.trade_currency_name=this.$store.state.trade_currency_name,this.isLogin?this.isDisable=!1:this.isDisable=!0},methods:{closeDialog:function(e){this[e]=!1},initUserInfo:function(){var e=this;window.localStorage.getItem("link_userInfo")&&Object(n.z)().then(function(t){if(1e3!==t.status)return!1;e.userInfo=t.data,0===parseFloat(e.userInfo.is_set_double_certification)&&(e.ruleForm.pass_double="0")}).catch(function(){})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){return 1!==t.userInfo.status?(t.$message.error(t.$t("translateLang.tradeDetail.text71")),!1):"1"!==t.userInfo.is_pwdtrade_exists.toString()?(t.$message.error(t.$t("translateLang.tradeDetail.text72")),!1):e?void(t.dialogVisible=!0):(t.changeByPrice(),parseFloat(t.ruleForm.buy_price)<1.1*t.tradeInfo.last_buy_price||(t.isToCnyHidden=!0),!1)})},submitData:function(e){var t=this,s=a()({},this.ruleForm);s.currency_id=this.tradeInfo.currency_id,s.trade_area_id=this.tradeInfo.trade_area_id,s.trade_password=l()(e),s.price_type=this.isSurePrice?1:2,this.dialogVisible=!1,Object(o.i)(s).then(function(e){if(1e3!==e.status)return t.$message.error(e.msg),!1;t.resetForm("ruleForm"),t.$emit("refresh"),t.$message.success(t.$t("tradeDetail.sell.part18"))}).catch(function(){})},changeByRange:function(){if(!this.ruleForm.sell_price)return this.slideData=0,!1;var e=parseFloat(this.tradeInfo.currency_sell_balance),t=e*this.slideData/100;isFinite(e)||(t=0),this.ruleForm.sell_num=0!==t?Math.floor(1e5*t)/1e5:0},changeByPrice:function(){return/.{1}/.test(this.ruleForm.sell_price)?(this.isToCnyHidden=!1,/^[0-9]*.[0-9]{0,6}$/.test(this.ruleForm.sell_price)||(this.ruleForm.sell_price=this.ruleForm.sell_price.match(/^[0-9]*.[0-9]{0,5}/)[0])):this.isToCnyHidden=!0,parseFloat(this.ruleForm.sell_price)&&/^[0-9]([0-9]|\.)*$/.test(this.ruleForm.sell_price)?this.ruleForm.sell_price>parseFloat(this.tradeInfo.currency_sell_balance)?(this.isToCnyHidden=!0,!1):void(this.percent<=1?this.slideData=100*parseFloat(this.percent):this.slideData=0):(this.isToCnyHidden=!0,!1)},changeByNum:function(){/.{1}/.test(this.ruleForm.sell_num)&&(/^[0-9]*.[0-9]{0,2}$/.test(this.ruleForm.sell_num)||(this.ruleForm.sell_num=this.ruleForm.sell_num.match(/^[0-9]*.[0-9]{0,1}/)[0])),this.percent<=1?this.slideData=100*parseFloat(this.percent):this.slideData=0},resetForm:function(e){this.$refs[e].resetFields()}}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sell-form"},[s("div",{staticClass:"title-second"},[e._v(e._s(e.$t("tradeDetail.sell.part2"))+" "+e._s(e.tradeInfo.currency_mark)+"： "),s("span",{staticClass:"c-red"},[e._v(e._s(e.tradeInfo.currency_sell_balance))])]),e._v(" "),s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules}},[0==e.isSurePrice?s("el-form-item",{staticClass:"to-cny-container",attrs:{prop:"sell_price",label:e.$t("translateLang.tradeDetail.text47")}},[s("el-input",{attrs:{placeholder:e.$t("tradeDetail.sell.part4"),disabled:e.isDisable},on:{input:function(t){e.changeByPrice()}},model:{value:e.ruleForm.sell_price,callback:function(t){e.$set(e.ruleForm,"sell_price","string"==typeof t?t.trim():t)},expression:"ruleForm.sell_price"}}),e._v(" "),"zn"==e.$i18n.locale?s("span",{staticClass:"to-cny",class:{hidden:e.isToCnyHidden}},[e._v(" ≈ "+e._s(e.toCny)+" CNY")]):e._e(),e._v(" "),"zh-hk"==e.$i18n.locale?s("span",{staticClass:"to-cny",class:{hidden:e.isToCnyHidden}},[e._v(" ≈ HK$ "+e._s(e.toHkb)+" ")]):e._e(),e._v(" "),"en"==e.$i18n.locale?s("span",{staticClass:"to-cny",class:{hidden:e.isToCnyHidden}},[e._v(" ≈ $ "+e._s(e.toUsb))]):e._e()],1):e._e(),e._v(" "),1==e.isSurePrice?s("el-form-item",{staticClass:"to-cny-container",attrs:{prop:"buy_price",label:e.$t("translateLang.tradeDetail.text47")}},[s("el-input",{attrs:{disabled:""},on:{input:function(t){e.changeByPrice()}},model:{value:e.tips,callback:function(t){e.tips=t},expression:"tips"}}),e._v(" "),"zn"==e.$i18n.locale?s("span",{staticClass:"to-cny",class:{hidden:e.isToCnyHidden}},[e._v(" ≈ "+e._s(e.toCny)+" CNY")]):e._e(),e._v(" "),"zh-hk"==e.$i18n.locale?s("span",{staticClass:"to-cny",class:{hidden:e.isToCnyHidden}},[e._v(" ≈ HK$ "+e._s(e.toHkb))]):e._e(),e._v(" "),"en"==e.$i18n.locale?s("span",{staticClass:"to-cny",class:{hidden:e.isToCnyHidden}},[e._v(" ≈ $ "+e._s(e.toUsb))]):e._e()],1):e._e(),e._v(" "),s("el-form-item",{attrs:{prop:"sell_num",label:e.$t("translateLang.tradeDetail.text48")}},[s("el-input",{attrs:{placeholder:e.$t("tradeDetail.sell.part6"),disabled:e.isDisable},model:{value:e.ruleForm.sell_num,callback:function(t){e.$set(e.ruleForm,"sell_num","string"==typeof t?t.trim():t)},expression:"ruleForm.sell_num"}})],1),e._v(" "),s("div",{staticClass:"clearfix"},[s("el-slider",{staticClass:"pull-left slider",on:{input:function(t){e.changeByRange()}},model:{value:e.slideData,callback:function(t){e.slideData=t},expression:"slideData"}})],1),e._v(" "),s("div",{staticClass:"toComputed"},[s("span",{staticStyle:{width:"60px",display:"inline-block"}},[e._v(e._s(e.$t("translateLang.tradeDetail.text3")))]),e._v("  "+e._s(e.convert)+e._s(e.tradeInfo.trade_currency_mark)+" "),s("span",{staticClass:"c-gray"},[e._v("("+e._s(e.$t("tradeDetail.sell.part9"))+e._s(e.tradeInfo.currency_sell_fee)+"%)")])]),e._v(" "),s("el-form-item",[s("el-button",{staticClass:"sell-btn1",attrs:{disabled:e.isDisable},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v(e._s(e.$t("tradeDetail.sell.part10")))])],1)],1),e._v(" "),s("password-dialog",{attrs:{dialogVisible:e.dialogVisible},on:{submitData:e.submitData,closeDialog:e.closeDialog}})],1)},staticRenderFns:[]};var u=s("VU/8")(c,d,!1,function(e){s("vQSN"),s("e67b")},"data-v-79c80bef",null);t.default=u.exports},vQSN:function(e,t){}});
//# sourceMappingURL=25.b9420a7b4e0fafe76454.js.map